<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Jerakia</title>
    
    <link rel="stylesheet" href="/css/minimal.css">
    <link rel="stylesheet" href="/css/pygment_trac.css">
    <script src="/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <headercontainer>
        <header>
        <h1>Jerakia</h1>
        <p>A versatile data lookup system</p>
        <ul>
          <li><a href="https://rubygems.org/gems/jerakia/">Download <strong>Gem</strong></a></li>
          <li><a href="https://github.com/crayfishx/jerakia">View On <strong>GitHub</strong></a></li>
          <li><a href="https://forge.puppetlabs.com/crayfishx/jerakia">Install with<strong>Puppet</strong></a></li>
        </ul>
        </header>
        <menusection>
        <li><a href="/">Home</a></li>
        <br/>
        <li><a href="/basics">Basics</a></li>
        <ul>
          <li><a href="/basics/config">Configuring</a></li>
          <li><a href="/basics/lookups">Jerakia Lookups</a></li>
        </ul>
        <li><a href="/tutorial/">Quickstart Tutorial</a></li>
        <ul>
          <li><a href="/tutorial/installing">Installing Jerakia</a></li>
          <li><a href="/tutorial/config">Configuring</a></li>
          <li><a href="/tutorial/policy">Writing a policy</a></li>
          <li><a href="/tutorial/lookup">Writing a lookup</a></li>
          <li><a href="/tutorial/data">Populating data</a></li>
          <li><a href="/tutorial/command1">Running the jerakia command</a></li>
          <li><a href="/tutorial/override">Overriding data in the hierarchy</a></li>
        </ul>
        <li><a href="/lookups">Lookups</a></li>
        <ul>
          <li><a href="/lookups/plugins">Using lookup plugins</a></li>
          <li><a href="/lookup/output_handlers">Using output handlers</a></li>
        </ul>
        <li><a href="/datasources">Datasources</a></li>
        <ul>
          <li><a href="/datasources/file">File datasource</a></li>
          <li><a href="/datasources/http">HTTP datasource</a></li>
          <li><a href="/datasources/writing">Writing datasources</a></li>
        </ul>
        <li><a href="/plugins">Lookup plugins</a></li>
        <ul>
          <li><a href="/plugins/confine">Confine plugin</a></li>
          <li><a href="/plugins/hiera">Hiera plugin</a></li>
          <li><a href="/plugins/writing">Writing custom lookup plugins</a></li>
        </ul>
        <li><a href="/outputhandlers">Output Handlers</a></li>
        <ul>
          <li><a href="/outputhandlers/encryption">Encryption output handler (eyaml)</a></li>
          <li><a href="/outputhandlers/substr">Substr output plugin</a></li>
          <li><a href="/outputhandlers/writing">Writing your own output handlers</a></li>
        </ul>



        </menusection>
        </headercontainer>
      <section>
        <h1 id="jerakia_lookups">Jerakia Lookups</h1>

<p>Lookup blocks define where and how to source the data. At a minmum a lookup block must specify a <code>datasource</code> to pass the request to. Data sources can optionally take a hash of arguments. Look at each datasourceâ€™s documentation for information on what options they support.</p>

<p>Supported methods are</p>

<ul>
<li><code>datasource, {opts}</code> data source with corresponding options</li>

<li><code>invalidate</code> disable this lookup</li>

<li><code>scope</code> return the scope object</li>

<li><code>output_handler</code> add an output handler to this request</li>

<li><code>stop</code> Do not proceed to the next lookup <em>if this lookup is deemed valid</em>, regardless of whether data is returned</li>

<li><code>confine</code> Confine this lookup to a set of criteria</li>

<li><code>exclude</code> Exclude this lookup if the criteria is matched</li>
</ul>

<h2 id="example">Example</h2>

<p>Here is an example of a Jerakia lookup contained within a policy</p>
<div class='highlight'><pre><code class='language-ruby' data-lang='ruby'><span class='n'>policy</span> <span class='ss'>:default</span> <span class='k'>do</span>
  <span class='n'>lookup</span> <span class='ss'>:main</span> <span class='k'>do</span>
    <span class='n'>datasource</span> <span class='ss'>:file</span><span class='p'>,</span> <span class='p'>{</span>
      <span class='ss'>:format</span> <span class='o'>=&gt;</span> <span class='ss'>:yaml</span><span class='p'>,</span>
      <span class='ss'>:extension</span> <span class='o'>=&gt;</span> <span class='s1'>&#39;yaml&#39;</span><span class='p'>,</span>
      <span class='ss'>:docroot</span> <span class='o'>=&gt;</span> <span class='s1'>&#39;/etc/jerakia/data&#39;</span><span class='p'>,</span>
      <span class='ss'>:searchpath</span> <span class='o'>=&gt;</span> <span class='o'>[</span>
        <span class='n'>scope</span><span class='o'>[</span><span class='ss'>:certname</span><span class='o'>]</span><span class='p'>,</span>
        <span class='n'>scope</span><span class='o'>[</span><span class='ss'>:environment</span><span class='o'>]</span><span class='p'>,</span>
        <span class='s1'>&#39;global&#39;</span><span class='p'>,</span>
      <span class='o'>]</span>
    <span class='p'>},</span>
  <span class='k'>end</span>
<span class='k'>end</span></code></pre></div>
      </section>
      <footer>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><!--<![endif]-->
  </body>
</html>
