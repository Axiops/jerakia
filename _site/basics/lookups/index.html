<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Jerakia</title>
    
    <link rel="stylesheet" href="/css/minimal.css">
    <link rel="stylesheet" href="/css/pygment_trac.css">
    <script src="/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <headercontainer>
        <header>
        <h1>Jerakia</h1>
        <p>A versatile data lookup system</p>
        <ul>
          <li><a href="https://rubygems.org/gems/jerakia/">Download <strong>Gem</strong></a></li>
          <li><a href="https://github.com/crayfishx/jerakia">View On <strong>GitHub</strong></a></li>
          <li><a href="https://forge.puppetlabs.com/crayfishx/jerakia">Install with<strong>Puppet</strong></a></li>
        </ul>
        </header>
        <menusection>
        <li><a href="/">Home</a></li>
        <br/>
        <li><a href="/basics">Basics</a></li>
        <ul>
          <li><a href="/basics/install">Installing</a></li>
          <li><a href="/basics/configure">Configuring</a></li>
          <li><a href="/basics/lookups">Understanding Jerakia Lookups</a></li>
          <li><a href="/basics/cli">Command line interface</a></li>
        </ul>
        <li><a href="/tutorial/">Quickstart Tutorial</a></li>
        <ul>
          <li><a href="/tutorial/installing">Installing Jerakia</a></li>
          <li><a href="/tutorial/config">Configuring</a></li>
          <li><a href="/tutorial/policy">Writing a policy</a></li>
          <li><a href="/tutorial/lookup">Writing a lookup</a></li>
          <li><a href="/tutorial/data">Populating data</a></li>
          <li><a href="/tutorial/command1">Running the jerakia command</a></li>
          <li><a href="/tutorial/override">Overriding data in the hierarchy</a></li>
        </ul>
        <li><a href="/lookups">Lookups</a></li>
        <ul>
          <li><a href="/lookups/plugins">Using lookup plugins</a></li>
        </ul>
        <li><a href="/datasources">Datasources</a></li>
        <ul>
          <li><a href="/datasources/file">File datasource</a></li>
          <li><a class=pending href="/pending">HTTP datasource</a></li>
          <li><a href="/datasources/dummy">Dummy datasource</a></li>
          <li><a class="pending" href="/pending">Writing datasources</a></li>
        </ul>
        <li><a href="/pending">Lookup plugins</a></li>
        <ul>
          <li><a class="pending" href="/pending">Hiera plugin</a></li>
          <li><a class="pending" href="/pending">Writing custom lookup plugins</a></li>
        </ul>
        <li><a href="/pending">Response Filters</a></li>
        <ul>
          <li><a class="pending" href="/pending">Encryption response filter (eyaml)</a></li>
          <li><a class="pending" href="/pending">Substr response filter</a></li>
          <li><a class="pending" href="/pending">Writing your own reponse filters</a></li>
        </ul>



        </menusection>
      <footer>
      <br/><br/>
      <p>Sponsored by</p>
      <p><a href="http://www.enviatics.com"><img src="/images/logo_enviatics.png" alt="Enviatics"></a></p>
      <p><a href="http://baloise.github.io"><img src="/images/logo_baloise_Fotor.png" alt="baloise open source"></a></p>
      <br><br><br>
      <p><small>Hosted by <a href="https://pages.github.io">GitHub Pages</a></small></p>
      <p><small>Theme adapted from <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
        </headercontainer>
      <section>
        <h1 id="basics">Basics</h1>

<h2 id="understanding_jerakia_lookups">Understanding Jerakia lookups</h2>

<p>There are three important things that are contained within a Jerakia lookup, these are ;</p>

<h4 id="the_lookup_key">The lookup <em>key</em></h4>

<p>The key is the item that we are looking up and contains the value</p>

<h4 id="the_lookup_namespace">The lookup <em>namespace</em></h4>

<p>In Jerakia, each key is stored within a namespace. A namespace can itself be a hierarchy and is sent within the lookup as an array. When using Jerakia with Puppet, the namespace is built from the Puppet class that is requesting the lookup. Hiera users will be familar with the concept of <code>$port</code> in the <code>apache</code> class being configured in Hiera as a single key called <code>apache::port</code>. In Jerakia, this data would be stored as the <em>key</em> <code>port</code> in the <em>namespace</em> <code>apache</code>.</p>

<h4 id="the_lookup_scope">The lookup <em>scope</em></h4>

<p>The scope is key/value information sent by the requestor and is used by the datasource to determine how to lookup the data. Scope may contain any information such as environments, locations, names or roles of the requestor. When using Jerakia with Puppet in itâ€™s default mode, the scope would contain all of the facts and top-level variables of the agent.</p>

<h4 id="the_datasource">The datasource</h4>

<p>Jerakia lookup always define a datasource to use for the lookup request. Datasources are pluggable, by default Jerakia ships with <em>file</em> and <em>http</em>.</p>

<h2 id="an_example_lookup">An example lookup</h2>
<div class='highlight'><pre><code class='language-ruby' data-lang='ruby'><span class='n'>lookup</span> <span class='ss'>:main</span> <span class='k'>do</span>
  <span class='n'>datasource</span> <span class='ss'>:file</span><span class='p'>,</span> <span class='p'>{</span>
    <span class='ss'>:format</span>     <span class='o'>=&gt;</span> <span class='ss'>:yaml</span><span class='p'>,</span>
    <span class='ss'>:docroot</span>    <span class='o'>=&gt;</span> <span class='s2'>&quot;/var/lib/jerakia&quot;</span><span class='p'>,</span>
    <span class='ss'>:searchpath</span> <span class='o'>[</span>
      <span class='s2'>&quot;host/</span><span class='si'>#{</span><span class='n'>scope</span><span class='o'>[</span><span class='ss'>:fqdn</span><span class='o'>]</span><span class='si'>}</span><span class='s2'>&quot;</span><span class='p'>,</span>
      <span class='s2'>&quot;env/</span><span class='si'>#{</span><span class='n'>scope</span><span class='o'>[</span><span class='ss'>:environment</span><span class='o'>]</span><span class='si'>}</span><span class='s2'>&quot;</span><span class='p'>,</span>
      <span class='s2'>&quot;common&quot;</span>
    <span class='o'>]</span>
  <span class='p'>}</span>
<span class='k'>end</span></code></pre></div>
<p>Learn more about <a href="/lookups">How to configure Jerakia lookups</a></p>
      </section>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><!--<![endif]-->
  </body>
</html>
